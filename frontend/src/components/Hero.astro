---
import { Image } from "astro:assets";
import heroLogo from "../assets/hero-logo.svg";
import backgroundVideo from "../assets/atomcraft-background.mp4";
import backgroundPoster from "../assets/atomcraft-background_000.jpg";
import PrimaryButton from "./buttons/PrimaryButton.astro";
import SecondaryOutlineButton from "./buttons/SecondaryOutlineButton.astro";
---

<div class="relative h-screen w-full overflow-hidden">
  <video
    class="absolute top-0 left-0 z-1 h-full w-full object-cover"
    crossorigin="anonymous"
    playsinline
    preload="auto"
    muted
    loop
    autoplay
    poster={backgroundPoster.src}
    src={backgroundVideo}></video>
  <div
    class="relative z-3 flex h-full w-full items-center justify-center md:mt-[100px]"
  >
    <div class="flex w-full flex-col items-center gap-5 md:pb-[25vh]">
      <div
        class="relative flex w-full flex-col items-center py-[30px] sm:py-[50px] md:py-[100px]"
      >
        <div
          class="absolute inset-0 z-0 rounded-lg bg-[linear-gradient(to_bottom,transparent_0%,rgba(0,0,0,0.4)_25%,rgba(0,0,0,0.4)_75%,transparent_100%)] md:bg-[linear-gradient(to_bottom,transparent_0%,rgba(0,0,0,0.6)_25%,rgba(0,0,0,0.6)_75%,transparent_100%)]"
        >
        </div>
        <h1
          id="line-1"
          class="text-heading-4 sm:text-heading-3 md:text-heading-2 lg:text-heading-1 invisible font-bold will-change-transform"
        >
          Crafting the
        </h1>
        <h1
          id="line-2"
          class="text-heading-4 sm:text-heading-3 md:text-heading-2 lg:text-heading-1 gradient-text invisible font-bold will-change-transform"
        >
          Future of Fusion
        </h1>
        <h2
          id="line-3"
          class="md:text-heading-5 lg:text-heading-4 invisible z-5 mb-[20px] text-center md:mb-[60px]"
        >
          World's first student-led fusion energy device.
        </h2>
        <div class="z-5 flex gap-[29px]">
          <PrimaryButton href="news" id="hero-button-1" class="invisible">
            Apply Now
          </PrimaryButton>
          <SecondaryOutlineButton href="/" id="hero-button-2" class="invisible">
            Learn More
          </SecondaryOutlineButton>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  import { SplitText } from "gsap/SplitText";

  gsap.registerPlugin(ScrollTrigger, SplitText);
  document.addEventListener("DOMContentLoaded", () => {
    // SplitText combined with bg-clip-text breaks on chrome but works on firefox
    // idk why ill figure it out later

    // const line1Split = SplitText.create("#line-1", { type: "words" })
    // const line2Split = SplitText.create("#line-2", { type: "words" })

    const timeline = gsap.timeline({
      scrollTrigger: {
        start: "top 80%",
        trigger: "#line-1",
        once: true,
      },
    });

    timeline.fromTo(
      "#line-1",
      { y: 30, autoAlpha: 0 },
      {
        y: 0,
        autoAlpha: 1,
        duration: 1.5,
        ease: "power3.out",
      },
      "0.3",
    );

    timeline.fromTo(
      "#line-2",
      { y: 30, autoAlpha: 0 },
      {
        y: 0,
        autoAlpha: 1,
        stagger: 0.1,
        duration: 1.5,
        ease: "power3.out",
      },
      "0.7",
    );

    timeline.fromTo(
      "#line-3",
      { y: 30, autoAlpha: 0 },
      {
        y: 0,
        autoAlpha: 1,
        stagger: 0.1,
        duration: 1.5,
        ease: "power3.out",
      },
      "1.3",
    );

    timeline.fromTo(
      "#hero-button-1",
      { y: 30, autoAlpha: 0 },
      {
        y: 0,
        autoAlpha: 1,
        stagger: 0.1,
        duration: 1.5,
        ease: "power3.out",
        opacity: 1,
      },
      "1.5",
    );

    timeline.fromTo(
      "#hero-button-2",
      { y: 30, autoAlpha: 0 },
      {
        y: 0,
        autoAlpha: 1,
        stagger: 0.1,
        duration: 1.5,
        ease: "power3.out",
      },
      "1.7",
    );
  });
</script>
